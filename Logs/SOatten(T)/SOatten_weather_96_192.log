Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=252, d_ortho=49, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST_orthoConv_L', model_id='96_192', moving_avg=25, n_heads=28, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=10, pct_start=0.3, pred_len=192, random_seed=2021, revin=1, root_path='/data1/mazc/whxProject/Dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=30, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 96_192_PatchTST_orthoConv_L_custom_ftM_sl96_ll48_pl192_dm252_nh28_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.8817544
	speed: 0.4430s/iter; left time: 3743.9417s
	iters: 200, epoch: 1 | loss: 0.8900714
	speed: 0.3415s/iter; left time: 2852.1107s
Epoch: 1 cost time: 109.38889598846436
Epoch: 1, Steps: 285 | Train Loss: 0.7916009 Vali Loss: 0.6262584 Test Loss: 0.2619456
Validation loss decreased (inf --> 0.626258).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7026567
	speed: 1.4873s/iter; left time: 12145.0898s
	iters: 200, epoch: 2 | loss: 0.6285432
	speed: 0.3213s/iter; left time: 2591.9227s
Epoch: 2 cost time: 94.89095854759216
Epoch: 2, Steps: 285 | Train Loss: 0.5850766 Vali Loss: 0.5374879 Test Loss: 0.2374287
Validation loss decreased (0.626258 --> 0.537488).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6964582
	speed: 1.5236s/iter; left time: 12007.1216s
	iters: 200, epoch: 3 | loss: 0.4906428
	speed: 0.3374s/iter; left time: 2625.0537s
Epoch: 3 cost time: 101.91297769546509
Epoch: 3, Steps: 285 | Train Loss: 0.5523250 Vali Loss: 0.5307419 Test Loss: 0.2331827
Validation loss decreased (0.537488 --> 0.530742).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4051247
	speed: 1.4419s/iter; left time: 10952.6067s
	iters: 200, epoch: 4 | loss: 0.4528032
	speed: 0.3235s/iter; left time: 2424.7310s
Epoch: 4 cost time: 92.39410948753357
Epoch: 4, Steps: 285 | Train Loss: 0.5402658 Vali Loss: 0.5150878 Test Loss: 0.2280184
Validation loss decreased (0.530742 --> 0.515088).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5893679
	speed: 1.5210s/iter; left time: 11120.1092s
	iters: 200, epoch: 5 | loss: 0.7182850
	speed: 0.3237s/iter; left time: 2334.4129s
Epoch: 5 cost time: 94.6754982471466
Epoch: 5, Steps: 285 | Train Loss: 0.5337453 Vali Loss: 0.5121943 Test Loss: 0.2276611
Validation loss decreased (0.515088 --> 0.512194).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.5942745
	speed: 1.5167s/iter; left time: 10656.5111s
	iters: 200, epoch: 6 | loss: 0.4223278
	speed: 0.2677s/iter; left time: 1854.4120s
Epoch: 6 cost time: 80.82184839248657
Epoch: 6, Steps: 285 | Train Loss: 0.5257842 Vali Loss: 0.5166040 Test Loss: 0.2290271
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.5689918
	speed: 1.4707s/iter; left time: 9914.2391s
	iters: 200, epoch: 7 | loss: 0.4598388
	speed: 0.3320s/iter; left time: 2204.8217s
Epoch: 7 cost time: 93.35442876815796
Epoch: 7, Steps: 285 | Train Loss: 0.5211706 Vali Loss: 0.5136424 Test Loss: 0.2263755
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.4228220
	speed: 1.4183s/iter; left time: 9156.5478s
	iters: 200, epoch: 8 | loss: 0.4578567
	speed: 0.3066s/iter; left time: 1948.9281s
Epoch: 8 cost time: 89.68304634094238
Epoch: 8, Steps: 285 | Train Loss: 0.5170464 Vali Loss: 0.5096403 Test Loss: 0.2254703
Validation loss decreased (0.512194 --> 0.509640).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.5600805
	speed: 1.5650s/iter; left time: 9657.4364s
	iters: 200, epoch: 9 | loss: 0.4798047
	speed: 0.3125s/iter; left time: 1897.2791s
Epoch: 9 cost time: 95.92960119247437
Epoch: 9, Steps: 285 | Train Loss: 0.5150569 Vali Loss: 0.5095443 Test Loss: 0.2260007
Validation loss decreased (0.509640 --> 0.509544).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.4162511
	speed: 1.3258s/iter; left time: 7803.5253s
	iters: 200, epoch: 10 | loss: 0.4883305
	speed: 0.2992s/iter; left time: 1731.3543s
Epoch: 10 cost time: 86.35516142845154
Epoch: 10, Steps: 285 | Train Loss: 0.5132183 Vali Loss: 0.5076020 Test Loss: 0.2253463
Validation loss decreased (0.509544 --> 0.507602).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.3742519
	speed: 1.5039s/iter; left time: 8423.4802s
	iters: 200, epoch: 11 | loss: 0.4300379
	speed: 0.3185s/iter; left time: 1751.9231s
Epoch: 11 cost time: 94.62744665145874
Epoch: 11, Steps: 285 | Train Loss: 0.5108294 Vali Loss: 0.5081437 Test Loss: 0.2253065
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.5220017
	speed: 1.4085s/iter; left time: 7487.7446s
	iters: 200, epoch: 12 | loss: 0.5740005
	speed: 0.3354s/iter; left time: 1749.3011s
Epoch: 12 cost time: 95.16139245033264
Epoch: 12, Steps: 285 | Train Loss: 0.5097914 Vali Loss: 0.5055752 Test Loss: 0.2241692
Validation loss decreased (0.507602 --> 0.505575).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.5595220
	speed: 1.3628s/iter; left time: 6856.4193s
	iters: 200, epoch: 13 | loss: 0.4122668
	speed: 0.2916s/iter; left time: 1437.9416s
Epoch: 13 cost time: 84.71789193153381
Epoch: 13, Steps: 285 | Train Loss: 0.5079459 Vali Loss: 0.5048376 Test Loss: 0.2238121
Validation loss decreased (0.505575 --> 0.504838).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.5038525
	speed: 1.3218s/iter; left time: 6273.4586s
	iters: 200, epoch: 14 | loss: 0.4877419
	speed: 0.3176s/iter; left time: 1475.4046s
Epoch: 14 cost time: 94.52723169326782
Epoch: 14, Steps: 285 | Train Loss: 0.5065560 Vali Loss: 0.5073634 Test Loss: 0.2244997
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.5545944
	speed: 1.5008s/iter; left time: 6694.9304s
	iters: 200, epoch: 15 | loss: 0.5232320
	speed: 0.3224s/iter; left time: 1405.8126s
Epoch: 15 cost time: 96.94462633132935
Epoch: 15, Steps: 285 | Train Loss: 0.5063106 Vali Loss: 0.5044180 Test Loss: 0.2243870
Validation loss decreased (0.504838 --> 0.504418).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.5442674
	speed: 1.3535s/iter; left time: 5652.4077s
	iters: 200, epoch: 16 | loss: 0.5892269
	speed: 0.2851s/iter; left time: 1161.9831s
Epoch: 16 cost time: 84.72267723083496
Epoch: 16, Steps: 285 | Train Loss: 0.5059534 Vali Loss: 0.5076080 Test Loss: 0.2245037
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.3634728
	speed: 1.4739s/iter; left time: 5735.0781s
	iters: 200, epoch: 17 | loss: 0.4767999
	speed: 0.3455s/iter; left time: 1309.6216s
Epoch: 17 cost time: 100.55840373039246
Epoch: 17, Steps: 285 | Train Loss: 0.5052049 Vali Loss: 0.5059183 Test Loss: 0.2226667
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.4454704
	speed: 1.6902s/iter; left time: 6094.7296s
	iters: 200, epoch: 18 | loss: 0.6527629
	speed: 0.3809s/iter; left time: 1335.4333s
Epoch: 18 cost time: 112.22381377220154
Epoch: 18, Steps: 285 | Train Loss: 0.5039883 Vali Loss: 0.5053511 Test Loss: 0.2234868
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.4287514
	speed: 1.6122s/iter; left time: 5353.9847s
	iters: 200, epoch: 19 | loss: 0.5579281
	speed: 0.3429s/iter; left time: 1104.3723s
Epoch: 19 cost time: 98.9068009853363
Epoch: 19, Steps: 285 | Train Loss: 0.5040761 Vali Loss: 0.5042047 Test Loss: 0.2231415
Validation loss decreased (0.504418 --> 0.504205).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.4603041
	speed: 1.4140s/iter; left time: 4292.8593s
	iters: 200, epoch: 20 | loss: 0.4946989
	speed: 0.3787s/iter; left time: 1111.8798s
Epoch: 20 cost time: 104.80363655090332
Epoch: 20, Steps: 285 | Train Loss: 0.5031070 Vali Loss: 0.5050002 Test Loss: 0.2230415
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.4051460
	speed: 1.4368s/iter; left time: 3952.5258s
	iters: 200, epoch: 21 | loss: 0.4337893
	speed: 0.3878s/iter; left time: 1028.1284s
Epoch: 21 cost time: 109.63615298271179
Epoch: 21, Steps: 285 | Train Loss: 0.5029075 Vali Loss: 0.5025153 Test Loss: 0.2229014
Validation loss decreased (0.504205 --> 0.502515).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.5264761
	speed: 1.7221s/iter; left time: 4246.7777s
	iters: 200, epoch: 22 | loss: 0.6655498
	speed: 0.3145s/iter; left time: 744.0215s
Epoch: 22 cost time: 90.27420330047607
Epoch: 22, Steps: 285 | Train Loss: 0.5028083 Vali Loss: 0.5042803 Test Loss: 0.2234345
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.6972149
	speed: 1.2322s/iter; left time: 2687.5293s
	iters: 200, epoch: 23 | loss: 0.7520472
	speed: 0.3534s/iter; left time: 735.4428s
Epoch: 23 cost time: 99.66612148284912
Epoch: 23, Steps: 285 | Train Loss: 0.5011482 Vali Loss: 0.5052694 Test Loss: 0.2232572
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.4643604
	speed: 1.8122s/iter; left time: 3435.9109s
	iters: 200, epoch: 24 | loss: 0.4612473
	speed: 0.3389s/iter; left time: 608.7211s
Epoch: 24 cost time: 100.9215075969696
Epoch: 24, Steps: 285 | Train Loss: 0.5019227 Vali Loss: 0.5062773 Test Loss: 0.2245843
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.5637734
	speed: 1.5179s/iter; left time: 2445.4105s
	iters: 200, epoch: 25 | loss: 0.4171449
	speed: 0.3249s/iter; left time: 490.8486s
Epoch: 25 cost time: 97.50135803222656
Epoch: 25, Steps: 285 | Train Loss: 0.5016330 Vali Loss: 0.5063609 Test Loss: 0.2235451
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.5379716
	speed: 1.5562s/iter; left time: 2063.4766s
	iters: 200, epoch: 26 | loss: 0.4920584
	speed: 0.3144s/iter; left time: 385.5049s
Epoch: 26 cost time: 98.10455203056335
Epoch: 26, Steps: 285 | Train Loss: 0.5008734 Vali Loss: 0.5064999 Test Loss: 0.2235365
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.3568370
	speed: 1.5297s/iter; left time: 1592.3664s
	iters: 200, epoch: 27 | loss: 0.4528425
	speed: 0.3496s/iter; left time: 328.9525s
Epoch: 27 cost time: 107.32989883422852
Epoch: 27, Steps: 285 | Train Loss: 0.5006057 Vali Loss: 0.5034983 Test Loss: 0.2228898
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.5348461
	speed: 1.6727s/iter; left time: 1264.5617s
	iters: 200, epoch: 28 | loss: 0.3981200
	speed: 0.2977s/iter; left time: 195.2839s
Epoch: 28 cost time: 93.17108702659607
Epoch: 28, Steps: 285 | Train Loss: 0.5008673 Vali Loss: 0.5068066 Test Loss: 0.2230147
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.6225306
	speed: 1.1740s/iter; left time: 552.9562s
	iters: 200, epoch: 29 | loss: 0.5478244
	speed: 0.3115s/iter; left time: 115.5814s
Epoch: 29 cost time: 94.53239488601685
Epoch: 29, Steps: 285 | Train Loss: 0.5001554 Vali Loss: 0.5032483 Test Loss: 0.2228043
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.4884526
	speed: 1.6714s/iter; left time: 310.8738s
	iters: 200, epoch: 30 | loss: 0.5870217
	speed: 0.3551s/iter; left time: 30.5355s
Epoch: 30 cost time: 108.28114438056946
Epoch: 30, Steps: 285 | Train Loss: 0.5004880 Vali Loss: 0.5054441 Test Loss: 0.2230636
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.8149737003040096e-06
>>>>>>>testing : 96_192_PatchTST_orthoConv_L_custom_ftM_sl96_ll48_pl192_dm252_nh28_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.2229011207818985, mae:0.2583807706832886, rse:0.6211148500442505

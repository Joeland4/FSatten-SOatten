Args in experiment:
Namespace(Decomposition=1, activation='gelu', batch_size=32, c_out=7, channel_independence=False, checkpoints='./checkpoints/', class_strategy='projection', d_ff=128, d_layers=1, d_model=147, d_ortho=49, data='ETTh2', data_path='ETTh2.csv', dec_in=7, des='Exp', devices='0,1', distil=True, do_predict=False, dropout=0.1, e_layers=2, efficient_training=False, embed='timeF', enc_in=7, exp_name='MTSF', factor=1, features='M', freq='h', gpu=0, inverse=False, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', model='FCA_v1', model_id='ETTh2_96_336', moving_avg=25, n_heads=3, num_workers=10, output_attention=False, partial_start_index=0, patience=10, pred_len=336, root_path='/data1/mazc/whxProject/Dataset/', seq_len=96, target='OT', target_data_path='electricity.csv', target_root_path='./data/electricity/', train_epochs=30, use_amp=False, use_gpu=True, use_multi_gpu=False, use_norm=True)
Use GPU: cuda:0
>>>>>>>start training : ETTh2_96_336_FCA_v1_ETTh2_M_ft96_sl48_ll336_pl147_dm3_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.4100230
	speed: 0.0376s/iter; left time: 284.8129s
	iters: 200, epoch: 1 | loss: 0.9072598
	speed: 0.0158s/iter; left time: 118.1453s
Epoch: 1 cost time: 6.663060426712036
Epoch: 1, Steps: 256 | Train Loss: 0.7036381 Vali Loss: 0.3791447 Test Loss: 0.4302113
Validation loss decreased (inf --> 0.379145).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4791279
	speed: 0.2118s/iter; left time: 1551.7376s
	iters: 200, epoch: 2 | loss: 0.4566904
	speed: 0.0402s/iter; left time: 290.7037s
Epoch: 2 cost time: 9.40718150138855
Epoch: 2, Steps: 256 | Train Loss: 0.6526300 Vali Loss: 0.3698137 Test Loss: 0.4230250
Validation loss decreased (0.379145 --> 0.369814).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3581004
	speed: 0.4379s/iter; left time: 3095.3325s
	iters: 200, epoch: 3 | loss: 0.6460971
	speed: 0.0746s/iter; left time: 519.7366s
Epoch: 3 cost time: 20.593348264694214
Epoch: 3, Steps: 256 | Train Loss: 0.6369597 Vali Loss: 0.3714271 Test Loss: 0.4196055
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4150627
	speed: 0.6068s/iter; left time: 4134.2614s
	iters: 200, epoch: 4 | loss: 0.4988660
	speed: 0.0621s/iter; left time: 417.1869s
Epoch: 4 cost time: 17.64912438392639
Epoch: 4, Steps: 256 | Train Loss: 0.6326139 Vali Loss: 0.3681792 Test Loss: 0.4202441
Validation loss decreased (0.369814 --> 0.368179).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3828797
	speed: 0.6240s/iter; left time: 4091.3617s
	iters: 200, epoch: 5 | loss: 0.9262006
	speed: 0.0794s/iter; left time: 512.7085s
Epoch: 5 cost time: 22.055639266967773
Epoch: 5, Steps: 256 | Train Loss: 0.6294750 Vali Loss: 0.3686663 Test Loss: 0.4196278
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4567594
	speed: 0.8673s/iter; left time: 5464.6457s
	iters: 200, epoch: 6 | loss: 0.7950753
	speed: 0.1278s/iter; left time: 792.3898s
Epoch: 6 cost time: 34.81329417228699
Epoch: 6, Steps: 256 | Train Loss: 0.6293786 Vali Loss: 0.3692030 Test Loss: 0.4195643
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.9839897
	speed: 0.9245s/iter; left time: 5588.6727s
	iters: 200, epoch: 7 | loss: 0.4320524
	speed: 0.1155s/iter; left time: 686.4837s
Epoch: 7 cost time: 31.650498151779175
Epoch: 7, Steps: 256 | Train Loss: 0.6278827 Vali Loss: 0.3670262 Test Loss: 0.4195849
Validation loss decreased (0.368179 --> 0.367026).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5589682
	speed: 0.8670s/iter; left time: 5019.2673s
	iters: 200, epoch: 8 | loss: 0.7504578
	speed: 0.0986s/iter; left time: 560.9800s
Epoch: 8 cost time: 27.324231147766113
Epoch: 8, Steps: 256 | Train Loss: 0.6281715 Vali Loss: 0.3693131 Test Loss: 0.4195640
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3657243
	speed: 0.7578s/iter; left time: 4192.9241s
	iters: 200, epoch: 9 | loss: 0.6430417
	speed: 0.0679s/iter; left time: 368.8652s
Epoch: 9 cost time: 18.464476346969604
Epoch: 9, Steps: 256 | Train Loss: 0.6279865 Vali Loss: 0.3680899 Test Loss: 0.4195657
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5450901
	speed: 0.5217s/iter; left time: 2753.2592s
	iters: 200, epoch: 10 | loss: 0.3692990
	speed: 0.1001s/iter; left time: 518.1457s
Epoch: 10 cost time: 24.747774839401245
Epoch: 10, Steps: 256 | Train Loss: 0.6290178 Vali Loss: 0.3690284 Test Loss: 0.4195603
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.5567672
	speed: 0.8767s/iter; left time: 4402.0863s
	iters: 200, epoch: 11 | loss: 0.5476861
	speed: 0.1002s/iter; left time: 493.0309s
Epoch: 11 cost time: 30.335736751556396
Epoch: 11, Steps: 256 | Train Loss: 0.6273248 Vali Loss: 0.3675155 Test Loss: 0.4195641
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.6177895
	speed: 0.7848s/iter; left time: 3739.5284s
	iters: 200, epoch: 12 | loss: 0.7916647
	speed: 0.1338s/iter; left time: 624.1670s
Epoch: 12 cost time: 35.93197727203369
Epoch: 12, Steps: 256 | Train Loss: 0.6275260 Vali Loss: 0.3677074 Test Loss: 0.4195614
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.7388548
	speed: 0.9411s/iter; left time: 4243.4237s
	iters: 200, epoch: 13 | loss: 0.6032624
	speed: 0.1539s/iter; left time: 678.5753s
Epoch: 13 cost time: 42.202924728393555
Epoch: 13, Steps: 256 | Train Loss: 0.6282445 Vali Loss: 0.3686212 Test Loss: 0.4195616
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.5266405
	speed: 0.9622s/iter; left time: 4092.0383s
	iters: 200, epoch: 14 | loss: 0.5211846
	speed: 0.1274s/iter; left time: 529.0885s
Epoch: 14 cost time: 34.75643849372864
Epoch: 14, Steps: 256 | Train Loss: 0.6281485 Vali Loss: 0.3680152 Test Loss: 0.4195607
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.4226203
	speed: 1.0309s/iter; left time: 4120.6569s
	iters: 200, epoch: 15 | loss: 0.8569617
	speed: 0.1387s/iter; left time: 540.4434s
Epoch: 15 cost time: 36.37350940704346
Epoch: 15, Steps: 256 | Train Loss: 0.6283112 Vali Loss: 0.3682196 Test Loss: 0.4195607
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.7335767
	speed: 1.0728s/iter; left time: 4013.2803s
	iters: 200, epoch: 16 | loss: 0.6217688
	speed: 0.1905s/iter; left time: 693.6341s
Epoch: 16 cost time: 50.158586502075195
Epoch: 16, Steps: 256 | Train Loss: 0.6280885 Vali Loss: 0.3684331 Test Loss: 0.4195609
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.7248709
	speed: 1.2656s/iter; left time: 4410.5750s
	iters: 200, epoch: 17 | loss: 0.6203481
	speed: 0.1685s/iter; left time: 570.3368s
Epoch: 17 cost time: 45.10195732116699
Epoch: 17, Steps: 256 | Train Loss: 0.6276615 Vali Loss: 0.3687815 Test Loss: 0.4195608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : ETTh2_96_336_FCA_v1_ETTh2_M_ft96_sl48_ll336_pl147_dm3_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41958481073379517, mae:0.4319113492965698

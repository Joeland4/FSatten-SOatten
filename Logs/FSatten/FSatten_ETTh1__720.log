Args in experiment:
Namespace(Decomposition=1, activation='gelu', batch_size=32, c_out=7, channel_independence=False, checkpoints='./checkpoints/', class_strategy='projection', d_ff=512, d_layers=1, d_model=490, d_ortho=49, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1', distil=True, do_predict=False, dropout=0.1, e_layers=2, efficient_training=False, embed='timeF', enc_in=7, exp_name='MTSF', factor=1, features='M', freq='h', gpu=0, inverse=False, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', model='FCA_v1', model_id='ETTh1_96_720', moving_avg=25, n_heads=10, num_workers=10, output_attention=False, partial_start_index=0, patience=10, pred_len=720, root_path='/data1/mazc/whxProject/Dataset/', seq_len=96, target='OT', target_data_path='electricity.csv', target_root_path='./data/electricity/', train_epochs=30, use_amp=False, use_gpu=True, use_multi_gpu=False, use_norm=True)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_96_720_FCA_v1_ETTh1_M_ft96_sl48_ll720_pl490_dm10_nh2_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6744255
	speed: 0.1796s/iter; left time: 1296.9556s
	iters: 200, epoch: 1 | loss: 0.6739793
	speed: 0.1222s/iter; left time: 870.4964s
Epoch: 1 cost time: 36.416486978530884
Epoch: 1, Steps: 244 | Train Loss: 0.6544661 Vali Loss: 1.5723382 Test Loss: 0.5126716
Validation loss decreased (inf --> 1.572338).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6473761
	speed: 0.8147s/iter; left time: 5683.8179s
	iters: 200, epoch: 2 | loss: 0.5580930
	speed: 0.1269s/iter; left time: 872.7705s
Epoch: 2 cost time: 31.96963620185852
Epoch: 2, Steps: 244 | Train Loss: 0.6062145 Vali Loss: 1.5702393 Test Loss: 0.4831351
Validation loss decreased (1.572338 --> 1.570239).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5993071
	speed: 0.8352s/iter; left time: 5623.4027s
	iters: 200, epoch: 3 | loss: 0.5627299
	speed: 0.1438s/iter; left time: 953.7765s
Epoch: 3 cost time: 37.05927610397339
Epoch: 3, Steps: 244 | Train Loss: 0.5887767 Vali Loss: 1.5753118 Test Loss: 0.4798438
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6153580
	speed: 0.8421s/iter; left time: 5464.0859s
	iters: 200, epoch: 4 | loss: 0.4982815
	speed: 0.1350s/iter; left time: 862.7430s
Epoch: 4 cost time: 36.35441565513611
Epoch: 4, Steps: 244 | Train Loss: 0.5784211 Vali Loss: 1.5835837 Test Loss: 0.4861252
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5466051
	speed: 0.8360s/iter; left time: 5220.9150s
	iters: 200, epoch: 5 | loss: 0.5437233
	speed: 0.1628s/iter; left time: 1000.5285s
Epoch: 5 cost time: 39.49582028388977
Epoch: 5, Steps: 244 | Train Loss: 0.5715414 Vali Loss: 1.5875885 Test Loss: 0.4822965
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6448374
	speed: 0.8638s/iter; left time: 5183.8747s
	iters: 200, epoch: 6 | loss: 0.5547554
	speed: 0.1504s/iter; left time: 887.2826s
Epoch: 6 cost time: 38.6007137298584
Epoch: 6, Steps: 244 | Train Loss: 0.5687055 Vali Loss: 1.5860585 Test Loss: 0.4889258
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6758028
	speed: 0.9260s/iter; left time: 5330.9510s
	iters: 200, epoch: 7 | loss: 0.5543076
	speed: 0.1945s/iter; left time: 1100.1327s
Epoch: 7 cost time: 51.03766942024231
Epoch: 7, Steps: 244 | Train Loss: 0.5667508 Vali Loss: 1.5865873 Test Loss: 0.4870627
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5463569
	speed: 1.1394s/iter; left time: 6281.6054s
	iters: 200, epoch: 8 | loss: 0.5846130
	speed: 0.1605s/iter; left time: 868.8146s
Epoch: 8 cost time: 43.047534704208374
Epoch: 8, Steps: 244 | Train Loss: 0.5666252 Vali Loss: 1.5889169 Test Loss: 0.4891362
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4725972
	speed: 0.8594s/iter; left time: 4528.2058s
	iters: 200, epoch: 9 | loss: 0.6309238
	speed: 0.1598s/iter; left time: 826.1827s
Epoch: 9 cost time: 39.09282445907593
Epoch: 9, Steps: 244 | Train Loss: 0.5663851 Vali Loss: 1.5903710 Test Loss: 0.4887753
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6169105
	speed: 0.9013s/iter; left time: 4528.9957s
	iters: 200, epoch: 10 | loss: 0.5574327
	speed: 0.1713s/iter; left time: 843.5151s
Epoch: 10 cost time: 42.957375049591064
Epoch: 10, Steps: 244 | Train Loss: 0.5661989 Vali Loss: 1.5904121 Test Loss: 0.4882964
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.5273458
	speed: 1.1168s/iter; left time: 5339.3800s
	iters: 200, epoch: 11 | loss: 0.5133723
	speed: 0.1896s/iter; left time: 887.5902s
Epoch: 11 cost time: 51.551958084106445
Epoch: 11, Steps: 244 | Train Loss: 0.5659065 Vali Loss: 1.5895354 Test Loss: 0.4881981
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.5203102
	speed: 1.1789s/iter; left time: 5348.7213s
	iters: 200, epoch: 12 | loss: 0.5439608
	speed: 0.2232s/iter; left time: 990.4020s
Epoch: 12 cost time: 59.44788455963135
Epoch: 12, Steps: 244 | Train Loss: 0.5656669 Vali Loss: 1.5902518 Test Loss: 0.4882326
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : ETTh1_96_720_FCA_v1_ETTh1_M_ft96_sl48_ll720_pl490_dm10_nh2_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 1, 720, 7) (2161, 1, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.4831351935863495, mae:0.4726927876472473

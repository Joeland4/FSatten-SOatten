Args in experiment:
Namespace(Decomposition=1, activation='gelu', batch_size=32, c_out=7, channel_independence=False, checkpoints='./checkpoints/', class_strategy='projection', d_ff=128, d_layers=1, d_model=147, d_ortho=49, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1', distil=True, do_predict=False, dropout=0.1, e_layers=2, efficient_training=False, embed='timeF', enc_in=7, exp_name='MTSF', factor=1, features='M', freq='h', gpu=0, inverse=False, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', model='FCA_v1', model_id='ETTm1_96_96', moving_avg=25, n_heads=3, num_workers=10, output_attention=False, partial_start_index=0, patience=10, pred_len=96, root_path='/data1/mazc/whxProject/Dataset/', seq_len=96, target='OT', target_data_path='electricity.csv', target_root_path='./data/electricity/', train_epochs=30, use_amp=False, use_gpu=True, use_multi_gpu=False, use_norm=True)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_96_96_FCA_v1_ETTm1_M_ft96_sl48_ll96_pl147_dm3_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4576237
	speed: 0.0609s/iter; left time: 1955.1308s
	iters: 200, epoch: 1 | loss: 0.4738340
	speed: 0.0227s/iter; left time: 728.3247s
	iters: 300, epoch: 1 | loss: 0.3790711
	speed: 0.0205s/iter; left time: 655.0536s
	iters: 400, epoch: 1 | loss: 0.3328013
	speed: 0.0184s/iter; left time: 584.8051s
	iters: 500, epoch: 1 | loss: 0.3605584
	speed: 0.0184s/iter; left time: 582.3662s
	iters: 600, epoch: 1 | loss: 0.3351038
	speed: 0.0183s/iter; left time: 579.3867s
	iters: 700, epoch: 1 | loss: 0.2862942
	speed: 0.0226s/iter; left time: 711.3844s
	iters: 800, epoch: 1 | loss: 0.2643467
	speed: 0.0219s/iter; left time: 688.7716s
	iters: 900, epoch: 1 | loss: 0.3163903
	speed: 0.0235s/iter; left time: 735.0081s
	iters: 1000, epoch: 1 | loss: 0.2950850
	speed: 0.0181s/iter; left time: 565.0663s
Epoch: 1 cost time: 25.53140926361084
Epoch: 1, Steps: 1074 | Train Loss: 0.3475240 Vali Loss: 0.4028467 Test Loss: 0.3476167
Validation loss decreased (inf --> 0.402847).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3142731
	speed: 0.5429s/iter; left time: 16856.8301s
	iters: 200, epoch: 2 | loss: 0.3838671
	speed: 0.0240s/iter; left time: 741.9081s
	iters: 300, epoch: 2 | loss: 0.3337381
	speed: 0.0239s/iter; left time: 737.5151s
	iters: 400, epoch: 2 | loss: 0.3032874
	speed: 0.0241s/iter; left time: 740.2926s
	iters: 500, epoch: 2 | loss: 0.3321061
	speed: 0.0240s/iter; left time: 735.5209s
	iters: 600, epoch: 2 | loss: 0.3121230
	speed: 0.0240s/iter; left time: 732.4274s
	iters: 700, epoch: 2 | loss: 0.3362221
	speed: 0.0217s/iter; left time: 660.5766s
	iters: 800, epoch: 2 | loss: 0.2876959
	speed: 0.0188s/iter; left time: 571.3321s
	iters: 900, epoch: 2 | loss: 0.2518666
	speed: 0.0188s/iter; left time: 568.0577s
	iters: 1000, epoch: 2 | loss: 0.2815770
	speed: 0.0188s/iter; left time: 567.5529s
Epoch: 2 cost time: 24.276127099990845
Epoch: 2, Steps: 1074 | Train Loss: 0.3038715 Vali Loss: 0.3999758 Test Loss: 0.3424812
Validation loss decreased (0.402847 --> 0.399976).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2874214
	speed: 0.5699s/iter; left time: 17080.2707s
	iters: 200, epoch: 3 | loss: 0.3199700
	speed: 0.0203s/iter; left time: 605.5951s
	iters: 300, epoch: 3 | loss: 0.2649941
	speed: 0.0243s/iter; left time: 722.5473s
	iters: 400, epoch: 3 | loss: 0.2923605
	speed: 0.0241s/iter; left time: 714.0770s
	iters: 500, epoch: 3 | loss: 0.2823768
	speed: 0.0241s/iter; left time: 713.6079s
	iters: 600, epoch: 3 | loss: 0.3582742
	speed: 0.0241s/iter; left time: 711.0271s
	iters: 700, epoch: 3 | loss: 0.2613624
	speed: 0.0241s/iter; left time: 708.1463s
	iters: 800, epoch: 3 | loss: 0.2918018
	speed: 0.0248s/iter; left time: 725.1930s
	iters: 900, epoch: 3 | loss: 0.2643220
	speed: 0.0241s/iter; left time: 702.2745s
	iters: 1000, epoch: 3 | loss: 0.2900465
	speed: 0.0240s/iter; left time: 697.7529s
Epoch: 3 cost time: 26.180936098098755
Epoch: 3, Steps: 1074 | Train Loss: 0.2906278 Vali Loss: 0.3926616 Test Loss: 0.3394539
Validation loss decreased (0.399976 --> 0.392662).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2494364
	speed: 0.5160s/iter; left time: 14911.4681s
	iters: 200, epoch: 4 | loss: 0.2792573
	speed: 0.0237s/iter; left time: 682.8326s
	iters: 300, epoch: 4 | loss: 0.2488956
	speed: 0.0237s/iter; left time: 679.5419s
	iters: 400, epoch: 4 | loss: 0.3044708
	speed: 0.0151s/iter; left time: 431.8858s
	iters: 500, epoch: 4 | loss: 0.2677889
	speed: 0.0118s/iter; left time: 336.0846s
	iters: 600, epoch: 4 | loss: 0.3248795
	speed: 0.0210s/iter; left time: 595.7777s
	iters: 700, epoch: 4 | loss: 0.2832100
	speed: 0.0238s/iter; left time: 673.5981s
	iters: 800, epoch: 4 | loss: 0.2661263
	speed: 0.0237s/iter; left time: 669.5503s
	iters: 900, epoch: 4 | loss: 0.2220809
	speed: 0.0200s/iter; left time: 560.9705s
	iters: 1000, epoch: 4 | loss: 0.3278940
	speed: 0.0129s/iter; left time: 361.4779s
Epoch: 4 cost time: 21.45319676399231
Epoch: 4, Steps: 1074 | Train Loss: 0.2852860 Vali Loss: 0.3915499 Test Loss: 0.3323047
Validation loss decreased (0.392662 --> 0.391550).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3107198
	speed: 0.5344s/iter; left time: 14868.4168s
	iters: 200, epoch: 5 | loss: 0.2401142
	speed: 0.0245s/iter; left time: 680.2579s
	iters: 300, epoch: 5 | loss: 0.2749415
	speed: 0.0242s/iter; left time: 669.3747s
	iters: 400, epoch: 5 | loss: 0.2879352
	speed: 0.0243s/iter; left time: 669.1305s
	iters: 500, epoch: 5 | loss: 0.2509368
	speed: 0.0246s/iter; left time: 673.9996s
	iters: 600, epoch: 5 | loss: 0.2142894
	speed: 0.0244s/iter; left time: 665.7205s
	iters: 700, epoch: 5 | loss: 0.2989109
	speed: 0.0192s/iter; left time: 522.7893s
	iters: 800, epoch: 5 | loss: 0.3339423
	speed: 0.0218s/iter; left time: 591.8043s
	iters: 900, epoch: 5 | loss: 0.2778139
	speed: 0.0154s/iter; left time: 416.3324s
	iters: 1000, epoch: 5 | loss: 0.3347602
	speed: 0.0120s/iter; left time: 323.3265s
Epoch: 5 cost time: 23.071521759033203
Epoch: 5, Steps: 1074 | Train Loss: 0.2827142 Vali Loss: 0.3893970 Test Loss: 0.3313902
Validation loss decreased (0.391550 --> 0.389397).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2611234
	speed: 0.5145s/iter; left time: 13762.7113s
	iters: 200, epoch: 6 | loss: 0.2818727
	speed: 0.0138s/iter; left time: 367.6318s
	iters: 300, epoch: 6 | loss: 0.2445548
	speed: 0.0117s/iter; left time: 310.5276s
	iters: 400, epoch: 6 | loss: 0.2799895
	speed: 0.0117s/iter; left time: 308.8192s
	iters: 500, epoch: 6 | loss: 0.2558149
	speed: 0.0116s/iter; left time: 306.3109s
	iters: 600, epoch: 6 | loss: 0.3497680
	speed: 0.0102s/iter; left time: 268.8113s
	iters: 700, epoch: 6 | loss: 0.2925144
	speed: 0.0102s/iter; left time: 267.4132s
	iters: 800, epoch: 6 | loss: 0.3028545
	speed: 0.0102s/iter; left time: 266.1244s
	iters: 900, epoch: 6 | loss: 0.2335814
	speed: 0.0102s/iter; left time: 265.7835s
	iters: 1000, epoch: 6 | loss: 0.3106661
	speed: 0.0101s/iter; left time: 261.4364s
Epoch: 6 cost time: 14.386772155761719
Epoch: 6, Steps: 1074 | Train Loss: 0.2814985 Vali Loss: 0.3892947 Test Loss: 0.3312733
Validation loss decreased (0.389397 --> 0.389295).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3000738
	speed: 0.5121s/iter; left time: 13149.6737s
	iters: 200, epoch: 7 | loss: 0.3033845
	speed: 0.0183s/iter; left time: 467.1971s
	iters: 300, epoch: 7 | loss: 0.2361797
	speed: 0.0184s/iter; left time: 469.3505s
	iters: 400, epoch: 7 | loss: 0.2419585
	speed: 0.0204s/iter; left time: 518.4061s
	iters: 500, epoch: 7 | loss: 0.2413985
	speed: 0.0131s/iter; left time: 331.5166s
	iters: 600, epoch: 7 | loss: 0.2671925
	speed: 0.0116s/iter; left time: 293.1883s
	iters: 700, epoch: 7 | loss: 0.2635701
	speed: 0.0116s/iter; left time: 291.3140s
	iters: 800, epoch: 7 | loss: 0.2992838
	speed: 0.0109s/iter; left time: 271.4052s
	iters: 900, epoch: 7 | loss: 0.2704044
	speed: 0.0102s/iter; left time: 252.9793s
	iters: 1000, epoch: 7 | loss: 0.2155017
	speed: 0.0102s/iter; left time: 252.3611s
Epoch: 7 cost time: 16.024171113967896
Epoch: 7, Steps: 1074 | Train Loss: 0.2809134 Vali Loss: 0.3894894 Test Loss: 0.3307156
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2286338
	speed: 0.5354s/iter; left time: 13171.3149s
	iters: 200, epoch: 8 | loss: 0.3396081
	speed: 0.0225s/iter; left time: 551.8074s
	iters: 300, epoch: 8 | loss: 0.2843825
	speed: 0.0244s/iter; left time: 595.1768s
	iters: 400, epoch: 8 | loss: 0.2913595
	speed: 0.0246s/iter; left time: 596.7327s
	iters: 500, epoch: 8 | loss: 0.2591068
	speed: 0.0246s/iter; left time: 595.2372s
	iters: 600, epoch: 8 | loss: 0.2624218
	speed: 0.0244s/iter; left time: 587.1608s
	iters: 700, epoch: 8 | loss: 0.3043982
	speed: 0.0244s/iter; left time: 585.9608s
	iters: 800, epoch: 8 | loss: 0.2857916
	speed: 0.0245s/iter; left time: 585.0715s
	iters: 900, epoch: 8 | loss: 0.2613650
	speed: 0.0241s/iter; left time: 573.5571s
	iters: 1000, epoch: 8 | loss: 0.2591386
	speed: 0.0242s/iter; left time: 573.7954s
Epoch: 8 cost time: 26.67075800895691
Epoch: 8, Steps: 1074 | Train Loss: 0.2806872 Vali Loss: 0.3891061 Test Loss: 0.3307368
Validation loss decreased (0.389295 --> 0.389106).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2851295
	speed: 0.5236s/iter; left time: 12320.2521s
	iters: 200, epoch: 9 | loss: 0.2253741
	speed: 0.0131s/iter; left time: 307.2568s
	iters: 300, epoch: 9 | loss: 0.2752118
	speed: 0.0136s/iter; left time: 317.4954s
	iters: 400, epoch: 9 | loss: 0.2976742
	speed: 0.0132s/iter; left time: 306.0632s
	iters: 500, epoch: 9 | loss: 0.3538792
	speed: 0.0131s/iter; left time: 304.0348s
	iters: 600, epoch: 9 | loss: 0.2757423
	speed: 0.0132s/iter; left time: 304.6560s
	iters: 700, epoch: 9 | loss: 0.2195284
	speed: 0.0124s/iter; left time: 285.2236s
	iters: 800, epoch: 9 | loss: 0.2699394
	speed: 0.0122s/iter; left time: 278.6266s
	iters: 900, epoch: 9 | loss: 0.2830934
	speed: 0.0122s/iter; left time: 277.9195s
	iters: 1000, epoch: 9 | loss: 0.2677580
	speed: 0.0135s/iter; left time: 304.6442s
Epoch: 9 cost time: 15.032052755355835
Epoch: 9, Steps: 1074 | Train Loss: 0.2802862 Vali Loss: 0.3890532 Test Loss: 0.3306768
Validation loss decreased (0.389106 --> 0.389053).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3118780
	speed: 0.5284s/iter; left time: 11865.9592s
	iters: 200, epoch: 10 | loss: 0.2560710
	speed: 0.0192s/iter; left time: 429.6265s
	iters: 300, epoch: 10 | loss: 0.2901448
	speed: 0.0193s/iter; left time: 428.5133s
	iters: 400, epoch: 10 | loss: 0.2610153
	speed: 0.0193s/iter; left time: 426.6663s
	iters: 500, epoch: 10 | loss: 0.3257164
	speed: 0.0192s/iter; left time: 424.3741s
	iters: 600, epoch: 10 | loss: 0.2825378
	speed: 0.0219s/iter; left time: 481.4090s
	iters: 700, epoch: 10 | loss: 0.2427674
	speed: 0.0241s/iter; left time: 526.5362s
	iters: 800, epoch: 10 | loss: 0.2975918
	speed: 0.0241s/iter; left time: 524.3634s
	iters: 900, epoch: 10 | loss: 0.2903893
	speed: 0.0241s/iter; left time: 522.5000s
	iters: 1000, epoch: 10 | loss: 0.3583152
	speed: 0.0241s/iter; left time: 519.1480s
Epoch: 10 cost time: 24.348721027374268
Epoch: 10, Steps: 1074 | Train Loss: 0.2803601 Vali Loss: 0.3891042 Test Loss: 0.3306288
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2822857
	speed: 0.5079s/iter; left time: 10859.5664s
	iters: 200, epoch: 11 | loss: 0.2788200
	speed: 0.0194s/iter; left time: 412.1883s
	iters: 300, epoch: 11 | loss: 0.2511087
	speed: 0.0193s/iter; left time: 409.6028s
	iters: 400, epoch: 11 | loss: 0.3396123
	speed: 0.0204s/iter; left time: 430.1146s
	iters: 500, epoch: 11 | loss: 0.2472287
	speed: 0.0216s/iter; left time: 453.9652s
	iters: 600, epoch: 11 | loss: 0.2409383
	speed: 0.0211s/iter; left time: 440.5983s
	iters: 700, epoch: 11 | loss: 0.2447854
	speed: 0.0241s/iter; left time: 501.0307s
	iters: 800, epoch: 11 | loss: 0.2719809
	speed: 0.0242s/iter; left time: 499.5402s
	iters: 900, epoch: 11 | loss: 0.2439887
	speed: 0.0243s/iter; left time: 499.1915s
	iters: 1000, epoch: 11 | loss: 0.2337743
	speed: 0.0231s/iter; left time: 473.9091s
Epoch: 11 cost time: 23.908323526382446
Epoch: 11, Steps: 1074 | Train Loss: 0.2802378 Vali Loss: 0.3891139 Test Loss: 0.3305952
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2330645
	speed: 0.5191s/iter; left time: 10541.4920s
	iters: 200, epoch: 12 | loss: 0.2811281
	speed: 0.0238s/iter; left time: 480.3282s
	iters: 300, epoch: 12 | loss: 0.2398764
	speed: 0.0243s/iter; left time: 488.6579s
	iters: 400, epoch: 12 | loss: 0.2195269
	speed: 0.0241s/iter; left time: 482.9294s
	iters: 500, epoch: 12 | loss: 0.2458893
	speed: 0.0241s/iter; left time: 480.5132s
	iters: 600, epoch: 12 | loss: 0.2946525
	speed: 0.0237s/iter; left time: 469.9365s
	iters: 700, epoch: 12 | loss: 0.2581730
	speed: 0.0158s/iter; left time: 311.8891s
	iters: 800, epoch: 12 | loss: 0.2728107
	speed: 0.0174s/iter; left time: 341.3352s
	iters: 900, epoch: 12 | loss: 0.2763046
	speed: 0.0243s/iter; left time: 474.9899s
	iters: 1000, epoch: 12 | loss: 0.2315224
	speed: 0.0217s/iter; left time: 421.5437s
Epoch: 12 cost time: 24.893470525741577
Epoch: 12, Steps: 1074 | Train Loss: 0.2804717 Vali Loss: 0.3890862 Test Loss: 0.3305852
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.3599616
	speed: 0.5939s/iter; left time: 11421.9013s
	iters: 200, epoch: 13 | loss: 0.2624179
	speed: 0.0176s/iter; left time: 336.1652s
	iters: 300, epoch: 13 | loss: 0.3535582
	speed: 0.0126s/iter; left time: 240.3951s
	iters: 400, epoch: 13 | loss: 0.2817221
	speed: 0.0128s/iter; left time: 242.2608s
	iters: 500, epoch: 13 | loss: 0.2412158
	speed: 0.0205s/iter; left time: 385.3823s
	iters: 600, epoch: 13 | loss: 0.2628005
	speed: 0.0243s/iter; left time: 455.4422s
	iters: 700, epoch: 13 | loss: 0.3004389
	speed: 0.0241s/iter; left time: 449.7562s
	iters: 800, epoch: 13 | loss: 0.2958702
	speed: 0.0245s/iter; left time: 453.3979s
	iters: 900, epoch: 13 | loss: 0.2279768
	speed: 0.0245s/iter; left time: 451.5301s
	iters: 1000, epoch: 13 | loss: 0.2730222
	speed: 0.0187s/iter; left time: 342.6334s
Epoch: 13 cost time: 22.67646884918213
Epoch: 13, Steps: 1074 | Train Loss: 0.2804585 Vali Loss: 0.3890854 Test Loss: 0.3305821
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.2718351
	speed: 0.5841s/iter; left time: 10606.6300s
	iters: 200, epoch: 14 | loss: 0.2594789
	speed: 0.0229s/iter; left time: 413.4360s
	iters: 300, epoch: 14 | loss: 0.2725916
	speed: 0.0231s/iter; left time: 415.6672s
	iters: 400, epoch: 14 | loss: 0.2505599
	speed: 0.0247s/iter; left time: 441.2321s
	iters: 500, epoch: 14 | loss: 0.2228706
	speed: 0.0243s/iter; left time: 431.5808s
	iters: 600, epoch: 14 | loss: 0.3286376
	speed: 0.0242s/iter; left time: 427.0073s
	iters: 700, epoch: 14 | loss: 0.3265842
	speed: 0.0194s/iter; left time: 339.9824s
	iters: 800, epoch: 14 | loss: 0.3494311
	speed: 0.0128s/iter; left time: 224.0799s
	iters: 900, epoch: 14 | loss: 0.2558518
	speed: 0.0128s/iter; left time: 222.2885s
	iters: 1000, epoch: 14 | loss: 0.2619526
	speed: 0.0164s/iter; left time: 282.6855s
Epoch: 14 cost time: 22.987977743148804
Epoch: 14, Steps: 1074 | Train Loss: 0.2801332 Vali Loss: 0.3891001 Test Loss: 0.3305795
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.3092625
	speed: 0.5779s/iter; left time: 9873.8647s
	iters: 200, epoch: 15 | loss: 0.2777776
	speed: 0.0194s/iter; left time: 328.7461s
	iters: 300, epoch: 15 | loss: 0.2517158
	speed: 0.0189s/iter; left time: 319.4624s
	iters: 400, epoch: 15 | loss: 0.3161906
	speed: 0.0191s/iter; left time: 319.8258s
	iters: 500, epoch: 15 | loss: 0.3293824
	speed: 0.0190s/iter; left time: 317.7525s
	iters: 600, epoch: 15 | loss: 0.3953922
	speed: 0.0174s/iter; left time: 287.9058s
	iters: 700, epoch: 15 | loss: 0.2563952
	speed: 0.0195s/iter; left time: 321.1616s
	iters: 800, epoch: 15 | loss: 0.2495722
	speed: 0.0151s/iter; left time: 248.0993s
	iters: 900, epoch: 15 | loss: 0.3121489
	speed: 0.0136s/iter; left time: 222.0593s
	iters: 1000, epoch: 15 | loss: 0.2264877
	speed: 0.0136s/iter; left time: 219.4957s
Epoch: 15 cost time: 19.554301261901855
Epoch: 15, Steps: 1074 | Train Loss: 0.2803022 Vali Loss: 0.3890938 Test Loss: 0.3305781
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.2725686
	speed: 0.5742s/iter; left time: 9192.8741s
	iters: 200, epoch: 16 | loss: 0.3549938
	speed: 0.0246s/iter; left time: 390.6793s
	iters: 300, epoch: 16 | loss: 0.3264643
	speed: 0.0245s/iter; left time: 388.1010s
	iters: 400, epoch: 16 | loss: 0.2968294
	speed: 0.0231s/iter; left time: 363.6026s
	iters: 500, epoch: 16 | loss: 0.3164926
	speed: 0.0189s/iter; left time: 294.8817s
	iters: 600, epoch: 16 | loss: 0.2113433
	speed: 0.0174s/iter; left time: 270.4014s
	iters: 700, epoch: 16 | loss: 0.3109955
	speed: 0.0192s/iter; left time: 295.4295s
	iters: 800, epoch: 16 | loss: 0.3286498
	speed: 0.0193s/iter; left time: 295.9374s
	iters: 900, epoch: 16 | loss: 0.2681963
	speed: 0.0186s/iter; left time: 282.4256s
	iters: 1000, epoch: 16 | loss: 0.3231576
	speed: 0.0167s/iter; left time: 252.3237s
Epoch: 16 cost time: 22.324631929397583
Epoch: 16, Steps: 1074 | Train Loss: 0.2802636 Vali Loss: 0.3890741 Test Loss: 0.3305780
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.2913193
	speed: 0.6098s/iter; left time: 9107.8403s
	iters: 200, epoch: 17 | loss: 0.2113159
	speed: 0.0235s/iter; left time: 348.1827s
	iters: 300, epoch: 17 | loss: 0.3389879
	speed: 0.0191s/iter; left time: 280.9500s
	iters: 400, epoch: 17 | loss: 0.2437818
	speed: 0.0234s/iter; left time: 343.0043s
	iters: 500, epoch: 17 | loss: 0.2461824
	speed: 0.0243s/iter; left time: 353.3015s
	iters: 600, epoch: 17 | loss: 0.2656629
	speed: 0.0243s/iter; left time: 350.2342s
	iters: 700, epoch: 17 | loss: 0.2800497
	speed: 0.0248s/iter; left time: 355.2260s
	iters: 800, epoch: 17 | loss: 0.2649461
	speed: 0.0257s/iter; left time: 366.2007s
	iters: 900, epoch: 17 | loss: 0.2637841
	speed: 0.0247s/iter; left time: 348.9206s
	iters: 1000, epoch: 17 | loss: 0.3347047
	speed: 0.0235s/iter; left time: 330.0544s
Epoch: 17 cost time: 26.22658681869507
Epoch: 17, Steps: 1074 | Train Loss: 0.2802253 Vali Loss: 0.3890857 Test Loss: 0.3305780
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.2792201
	speed: 0.5798s/iter; left time: 8037.8882s
	iters: 200, epoch: 18 | loss: 0.2527070
	speed: 0.0205s/iter; left time: 282.5097s
	iters: 300, epoch: 18 | loss: 0.2246767
	speed: 0.0247s/iter; left time: 337.8146s
	iters: 400, epoch: 18 | loss: 0.2650118
	speed: 0.0138s/iter; left time: 187.4620s
	iters: 500, epoch: 18 | loss: 0.2633624
	speed: 0.0222s/iter; left time: 299.3957s
	iters: 600, epoch: 18 | loss: 0.2712576
	speed: 0.0246s/iter; left time: 328.9220s
	iters: 700, epoch: 18 | loss: 0.2707517
	speed: 0.0246s/iter; left time: 326.9003s
	iters: 800, epoch: 18 | loss: 0.2666434
	speed: 0.0253s/iter; left time: 333.4020s
	iters: 900, epoch: 18 | loss: 0.2665628
	speed: 0.0179s/iter; left time: 233.6729s
	iters: 1000, epoch: 18 | loss: 0.2792227
	speed: 0.0188s/iter; left time: 243.9474s
Epoch: 18 cost time: 23.360562801361084
Epoch: 18, Steps: 1074 | Train Loss: 0.2803566 Vali Loss: 0.3889930 Test Loss: 0.3305780
Validation loss decreased (0.389053 --> 0.388993).  Saving model ...
Updating learning rate to 7.62939453125e-10
	iters: 100, epoch: 19 | loss: 0.2478727
	speed: 0.5634s/iter; left time: 7205.6537s
	iters: 200, epoch: 19 | loss: 0.3427017
	speed: 0.0181s/iter; left time: 229.1681s
	iters: 300, epoch: 19 | loss: 0.3075893
	speed: 0.0236s/iter; left time: 297.3609s
	iters: 400, epoch: 19 | loss: 0.2925775
	speed: 0.0241s/iter; left time: 301.3480s
	iters: 500, epoch: 19 | loss: 0.2890602
	speed: 0.0242s/iter; left time: 299.5673s
	iters: 600, epoch: 19 | loss: 0.2410893
	speed: 0.0225s/iter; left time: 276.8850s
	iters: 700, epoch: 19 | loss: 0.2284743
	speed: 0.0212s/iter; left time: 258.3859s
	iters: 800, epoch: 19 | loss: 0.2576062
	speed: 0.0208s/iter; left time: 251.3832s
	iters: 900, epoch: 19 | loss: 0.2962752
	speed: 0.0243s/iter; left time: 291.7640s
	iters: 1000, epoch: 19 | loss: 0.2810370
	speed: 0.0243s/iter; left time: 289.3630s
Epoch: 19 cost time: 24.22725009918213
Epoch: 19, Steps: 1074 | Train Loss: 0.2804890 Vali Loss: 0.3890210 Test Loss: 0.3305780
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.814697265625e-10
	iters: 100, epoch: 20 | loss: 0.2665637
	speed: 0.5722s/iter; left time: 6703.8054s
	iters: 200, epoch: 20 | loss: 0.2747217
	speed: 0.0198s/iter; left time: 230.1191s
	iters: 300, epoch: 20 | loss: 0.2280307
	speed: 0.0156s/iter; left time: 179.4869s
	iters: 400, epoch: 20 | loss: 0.2627585
	speed: 0.0156s/iter; left time: 178.6115s
	iters: 500, epoch: 20 | loss: 0.2793913
	speed: 0.0182s/iter; left time: 205.7817s
	iters: 600, epoch: 20 | loss: 0.2652293
	speed: 0.0170s/iter; left time: 190.1057s
	iters: 700, epoch: 20 | loss: 0.2555880
	speed: 0.0131s/iter; left time: 145.9151s
	iters: 800, epoch: 20 | loss: 0.2996928
	speed: 0.0182s/iter; left time: 200.0572s
	iters: 900, epoch: 20 | loss: 0.3115420
	speed: 0.0169s/iter; left time: 184.3487s
	iters: 1000, epoch: 20 | loss: 0.2463900
	speed: 0.0174s/iter; left time: 187.8430s
Epoch: 20 cost time: 19.417751789093018
Epoch: 20, Steps: 1074 | Train Loss: 0.2802015 Vali Loss: 0.3890823 Test Loss: 0.3305780
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9073486328125e-10
	iters: 100, epoch: 21 | loss: 0.2993127
	speed: 0.6175s/iter; left time: 6571.3347s
	iters: 200, epoch: 21 | loss: 0.3003501
	speed: 0.0138s/iter; left time: 145.6955s
	iters: 300, epoch: 21 | loss: 0.2345172
	speed: 0.0157s/iter; left time: 164.1118s
	iters: 400, epoch: 21 | loss: 0.3206916
	speed: 0.0223s/iter; left time: 230.4206s
	iters: 500, epoch: 21 | loss: 0.2577962
	speed: 0.0235s/iter; left time: 240.7846s
	iters: 600, epoch: 21 | loss: 0.3494988
	speed: 0.0223s/iter; left time: 225.7639s
	iters: 700, epoch: 21 | loss: 0.2997414
	speed: 0.0170s/iter; left time: 170.2702s
	iters: 800, epoch: 21 | loss: 0.2749679
	speed: 0.0188s/iter; left time: 187.2127s
	iters: 900, epoch: 21 | loss: 0.2509312
	speed: 0.0241s/iter; left time: 237.0682s
	iters: 1000, epoch: 21 | loss: 0.2896303
	speed: 0.0196s/iter; left time: 191.2027s
Epoch: 21 cost time: 21.27537965774536
Epoch: 21, Steps: 1074 | Train Loss: 0.2803837 Vali Loss: 0.3890741 Test Loss: 0.3305780
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.5367431640625e-11
	iters: 100, epoch: 22 | loss: 0.2210722
	speed: 0.6124s/iter; left time: 5859.2852s
	iters: 200, epoch: 22 | loss: 0.2622299
	speed: 0.0231s/iter; left time: 218.9517s
	iters: 300, epoch: 22 | loss: 0.2743725
	speed: 0.0243s/iter; left time: 227.9802s
	iters: 400, epoch: 22 | loss: 0.2444135
	speed: 0.0228s/iter; left time: 211.1414s
	iters: 500, epoch: 22 | loss: 0.3045295
	speed: 0.0164s/iter; left time: 150.3676s
	iters: 600, epoch: 22 | loss: 0.2849955
	speed: 0.0128s/iter; left time: 116.3538s
	iters: 700, epoch: 22 | loss: 0.2883570
	speed: 0.0127s/iter; left time: 114.3097s
	iters: 800, epoch: 22 | loss: 0.2581793
	speed: 0.0140s/iter; left time: 124.2623s
	iters: 900, epoch: 22 | loss: 0.2708524
	speed: 0.0192s/iter; left time: 168.2334s
	iters: 1000, epoch: 22 | loss: 0.2823796
	speed: 0.0160s/iter; left time: 138.5136s
Epoch: 22 cost time: 20.720491647720337
Epoch: 22, Steps: 1074 | Train Loss: 0.2803222 Vali Loss: 0.3890899 Test Loss: 0.3305780
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.76837158203125e-11
	iters: 100, epoch: 23 | loss: 0.2336709
	speed: 0.6275s/iter; left time: 5329.0328s
	iters: 200, epoch: 23 | loss: 0.2602308
	speed: 0.0148s/iter; left time: 124.2631s
	iters: 300, epoch: 23 | loss: 0.2963759
	speed: 0.0150s/iter; left time: 124.3277s
	iters: 400, epoch: 23 | loss: 0.2827182
	speed: 0.0200s/iter; left time: 163.6839s
	iters: 500, epoch: 23 | loss: 0.2829362
	speed: 0.0165s/iter; left time: 133.7958s
	iters: 600, epoch: 23 | loss: 0.2431022
	speed: 0.0195s/iter; left time: 156.1982s
	iters: 700, epoch: 23 | loss: 0.2820086
	speed: 0.0196s/iter; left time: 154.5834s
	iters: 800, epoch: 23 | loss: 0.2585135
	speed: 0.0137s/iter; left time: 106.8742s
	iters: 900, epoch: 23 | loss: 0.2693790
	speed: 0.0199s/iter; left time: 152.8223s
	iters: 1000, epoch: 23 | loss: 0.2833944
	speed: 0.0190s/iter; left time: 144.3835s
Epoch: 23 cost time: 20.177815914154053
Epoch: 23, Steps: 1074 | Train Loss: 0.2802363 Vali Loss: 0.3890618 Test Loss: 0.3305780
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.384185791015625e-11
	iters: 100, epoch: 24 | loss: 0.2586653
	speed: 0.6230s/iter; left time: 4622.1675s
	iters: 200, epoch: 24 | loss: 0.2519516
	speed: 0.0216s/iter; left time: 158.3921s
	iters: 300, epoch: 24 | loss: 0.2833336
	speed: 0.0136s/iter; left time: 97.8966s
	iters: 400, epoch: 24 | loss: 0.2662480
	speed: 0.0135s/iter; left time: 96.2700s
	iters: 500, epoch: 24 | loss: 0.2861536
	speed: 0.0136s/iter; left time: 95.3767s
	iters: 600, epoch: 24 | loss: 0.3137261
	speed: 0.0138s/iter; left time: 95.4153s
	iters: 700, epoch: 24 | loss: 0.3432676
	speed: 0.0145s/iter; left time: 98.8551s
	iters: 800, epoch: 24 | loss: 0.2671587
	speed: 0.0167s/iter; left time: 112.2092s
	iters: 900, epoch: 24 | loss: 0.2369853
	speed: 0.0132s/iter; left time: 87.2218s
	iters: 1000, epoch: 24 | loss: 0.2730827
	speed: 0.0165s/iter; left time: 107.8319s
Epoch: 24 cost time: 18.707932949066162
Epoch: 24, Steps: 1074 | Train Loss: 0.2802570 Vali Loss: 0.3890737 Test Loss: 0.3305780
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1920928955078126e-11
	iters: 100, epoch: 25 | loss: 0.2737471
	speed: 0.6777s/iter; left time: 4300.3006s
	iters: 200, epoch: 25 | loss: 0.2160547
	speed: 0.0242s/iter; left time: 151.1375s
	iters: 300, epoch: 25 | loss: 0.2600781
	speed: 0.0268s/iter; left time: 164.6227s
	iters: 400, epoch: 25 | loss: 0.2985709
	speed: 0.0228s/iter; left time: 137.8923s
	iters: 500, epoch: 25 | loss: 0.3135206
	speed: 0.0236s/iter; left time: 140.4044s
	iters: 600, epoch: 25 | loss: 0.2715517
	speed: 0.0197s/iter; left time: 115.2863s
	iters: 700, epoch: 25 | loss: 0.2829199
	speed: 0.0211s/iter; left time: 121.2136s
	iters: 800, epoch: 25 | loss: 0.3410759
	speed: 0.0225s/iter; left time: 126.8198s
	iters: 900, epoch: 25 | loss: 0.2899109
	speed: 0.0230s/iter; left time: 127.7246s
	iters: 1000, epoch: 25 | loss: 0.2021837
	speed: 0.0178s/iter; left time: 97.1686s
Epoch: 25 cost time: 25.03471326828003
Epoch: 25, Steps: 1074 | Train Loss: 0.2802143 Vali Loss: 0.3889757 Test Loss: 0.3305780
Validation loss decreased (0.388993 --> 0.388976).  Saving model ...
Updating learning rate to 5.960464477539063e-12
	iters: 100, epoch: 26 | loss: 0.3484667
	speed: 0.7389s/iter; left time: 3894.8240s
	iters: 200, epoch: 26 | loss: 0.2259366
	speed: 0.0204s/iter; left time: 105.2895s
	iters: 300, epoch: 26 | loss: 0.2647929
	speed: 0.0185s/iter; left time: 93.9961s
	iters: 400, epoch: 26 | loss: 0.2487133
	speed: 0.0165s/iter; left time: 81.7988s
	iters: 500, epoch: 26 | loss: 0.3057179
	speed: 0.0163s/iter; left time: 79.2690s
	iters: 600, epoch: 26 | loss: 0.2735437
	speed: 0.0161s/iter; left time: 76.6281s
	iters: 700, epoch: 26 | loss: 0.2859467
	speed: 0.0159s/iter; left time: 74.4304s
	iters: 800, epoch: 26 | loss: 0.2840232
	speed: 0.0159s/iter; left time: 72.8257s
	iters: 900, epoch: 26 | loss: 0.2092281
	speed: 0.0168s/iter; left time: 75.0572s
	iters: 1000, epoch: 26 | loss: 0.2537029
	speed: 0.0165s/iter; left time: 72.2348s
Epoch: 26 cost time: 19.530121326446533
Epoch: 26, Steps: 1074 | Train Loss: 0.2803877 Vali Loss: 0.3890959 Test Loss: 0.3305780
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.9802322387695314e-12
	iters: 100, epoch: 27 | loss: 0.2866878
	speed: 0.7349s/iter; left time: 3084.3477s
	iters: 200, epoch: 27 | loss: 0.2568829
	speed: 0.0168s/iter; left time: 68.6542s
	iters: 300, epoch: 27 | loss: 0.2608844
	speed: 0.0204s/iter; left time: 81.4150s
	iters: 400, epoch: 27 | loss: 0.2449538
	speed: 0.0177s/iter; left time: 68.9691s
	iters: 500, epoch: 27 | loss: 0.3339561
	speed: 0.0196s/iter; left time: 74.3446s
	iters: 600, epoch: 27 | loss: 0.2649866
	speed: 0.0220s/iter; left time: 81.3504s
	iters: 700, epoch: 27 | loss: 0.2440072
	speed: 0.0168s/iter; left time: 60.5835s
	iters: 800, epoch: 27 | loss: 0.2867086
	speed: 0.0169s/iter; left time: 59.0702s
	iters: 900, epoch: 27 | loss: 0.2571865
	speed: 0.0158s/iter; left time: 53.6256s
	iters: 1000, epoch: 27 | loss: 0.2308303
	speed: 0.0164s/iter; left time: 54.0506s
Epoch: 27 cost time: 20.607789754867554
Epoch: 27, Steps: 1074 | Train Loss: 0.2802123 Vali Loss: 0.3890407 Test Loss: 0.3305780
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4901161193847657e-12
	iters: 100, epoch: 28 | loss: 0.2294386
	speed: 0.7319s/iter; left time: 2285.8628s
	iters: 200, epoch: 28 | loss: 0.2814114
	speed: 0.0166s/iter; left time: 50.3158s
	iters: 300, epoch: 28 | loss: 0.2597830
	speed: 0.0166s/iter; left time: 48.5842s
	iters: 400, epoch: 28 | loss: 0.2869706
	speed: 0.0199s/iter; left time: 56.2947s
	iters: 500, epoch: 28 | loss: 0.2181196
	speed: 0.0181s/iter; left time: 49.4120s
	iters: 600, epoch: 28 | loss: 0.2604308
	speed: 0.0134s/iter; left time: 35.2735s
	iters: 700, epoch: 28 | loss: 0.3993855
	speed: 0.0134s/iter; left time: 33.7722s
	iters: 800, epoch: 28 | loss: 0.2807008
	speed: 0.0147s/iter; left time: 35.6586s
	iters: 900, epoch: 28 | loss: 0.2643833
	speed: 0.0160s/iter; left time: 37.1675s
	iters: 1000, epoch: 28 | loss: 0.2746476
	speed: 0.0138s/iter; left time: 30.6574s
Epoch: 28 cost time: 18.327741146087646
Epoch: 28, Steps: 1074 | Train Loss: 0.2803832 Vali Loss: 0.3890880 Test Loss: 0.3305780
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.450580596923828e-13
	iters: 100, epoch: 29 | loss: 0.3548247
	speed: 0.7392s/iter; left time: 1514.6821s
	iters: 200, epoch: 29 | loss: 0.2885152
	speed: 0.0181s/iter; left time: 35.2226s
	iters: 300, epoch: 29 | loss: 0.3447243
	speed: 0.0187s/iter; left time: 34.5271s
	iters: 400, epoch: 29 | loss: 0.2716701
	speed: 0.0182s/iter; left time: 31.7667s
	iters: 500, epoch: 29 | loss: 0.2759445
	speed: 0.0170s/iter; left time: 28.0781s
	iters: 600, epoch: 29 | loss: 0.2802724
	speed: 0.0199s/iter; left time: 30.8192s
	iters: 700, epoch: 29 | loss: 0.2741790
	speed: 0.0177s/iter; left time: 25.7003s
	iters: 800, epoch: 29 | loss: 0.3088639
	speed: 0.0196s/iter; left time: 26.3936s
	iters: 900, epoch: 29 | loss: 0.2101821
	speed: 0.0207s/iter; left time: 25.8359s
	iters: 1000, epoch: 29 | loss: 0.3129958
	speed: 0.0171s/iter; left time: 19.6636s
Epoch: 29 cost time: 21.203928232192993
Epoch: 29, Steps: 1074 | Train Loss: 0.2802152 Vali Loss: 0.3890935 Test Loss: 0.3305780
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.725290298461914e-13
	iters: 100, epoch: 30 | loss: 0.2409306
	speed: 0.7566s/iter; left time: 737.6458s
	iters: 200, epoch: 30 | loss: 0.2225315
	speed: 0.0193s/iter; left time: 16.9033s
	iters: 300, epoch: 30 | loss: 0.2709608
	speed: 0.0183s/iter; left time: 14.1474s
	iters: 400, epoch: 30 | loss: 0.3002777
	speed: 0.0171s/iter; left time: 11.5335s
	iters: 500, epoch: 30 | loss: 0.2604860
	speed: 0.0164s/iter; left time: 9.4434s
	iters: 600, epoch: 30 | loss: 0.2763661
	speed: 0.0172s/iter; left time: 8.1720s
	iters: 700, epoch: 30 | loss: 0.2474097
	speed: 0.0199s/iter; left time: 7.4561s
	iters: 800, epoch: 30 | loss: 0.3357934
	speed: 0.0191s/iter; left time: 5.2546s
	iters: 900, epoch: 30 | loss: 0.2363609
	speed: 0.0219s/iter; left time: 3.8371s
	iters: 1000, epoch: 30 | loss: 0.2460091
	speed: 0.0169s/iter; left time: 1.2666s
Epoch: 30 cost time: 20.999089241027832
Epoch: 30, Steps: 1074 | Train Loss: 0.2802536 Vali Loss: 0.3890897 Test Loss: 0.3305780
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.862645149230957e-13
>>>>>>>testing : ETTm1_96_96_FCA_v1_ETTm1_M_ft96_sl48_ll96_pl147_dm3_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 1, 96, 7) (11425, 1, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.3305779695510864, mae:0.36949819326400757

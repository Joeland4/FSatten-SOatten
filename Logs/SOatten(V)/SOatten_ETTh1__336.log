Args in experiment:
Namespace(Decomposition=1, activation='gelu', batch_size=32, c_out=7, channel_independence=False, checkpoints='./checkpoints/', class_strategy='projection', d_ff=512, d_layers=1, d_model=490, d_ortho=49, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1', distil=True, do_predict=False, dropout=0.1, e_layers=2, efficient_training=False, embed='timeF', enc_in=7, exp_name='MTSF', factor=1, features='M', freq='h', gpu=0, inverse=False, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', model='orthoCA_AConv', model_id='ETTh1_96_336', moving_avg=25, n_heads=10, num_workers=10, output_attention=False, partial_start_index=0, patience=10, pred_len=336, root_path='/data1/mazc/whxProject/Dataset/', seq_len=96, target='OT', target_data_path='electricity.csv', target_root_path='./data/electricity/', train_epochs=30, use_amp=False, use_gpu=True, use_multi_gpu=False, use_norm=True)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_96_336_orthoCA_AConv_ETTh1_M_ft96_sl48_ll336_pl490_dm10_nh2_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.4679363
	speed: 0.0934s/iter; left time: 707.8019s
	iters: 200, epoch: 1 | loss: 0.5299078
	speed: 0.0273s/iter; left time: 204.1688s
Epoch: 1 cost time: 13.627168416976929
Epoch: 1, Steps: 256 | Train Loss: 0.5295693 Vali Loss: 1.2915233 Test Loss: 0.4903340
Validation loss decreased (inf --> 1.291523).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5046359
	speed: 0.3712s/iter; left time: 2719.1840s
	iters: 200, epoch: 2 | loss: 0.5261651
	speed: 0.0651s/iter; left time: 470.1917s
Epoch: 2 cost time: 17.776424169540405
Epoch: 2, Steps: 256 | Train Loss: 0.4881300 Vali Loss: 1.2796260 Test Loss: 0.4745663
Validation loss decreased (1.291523 --> 1.279626).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5623620
	speed: 0.3877s/iter; left time: 2740.6293s
	iters: 200, epoch: 3 | loss: 0.4892365
	speed: 0.0625s/iter; left time: 435.4056s
Epoch: 3 cost time: 17.45463991165161
Epoch: 3, Steps: 256 | Train Loss: 0.4760497 Vali Loss: 1.2823859 Test Loss: 0.4747317
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4782311
	speed: 0.3689s/iter; left time: 2513.1719s
	iters: 200, epoch: 4 | loss: 0.4601736
	speed: 0.0691s/iter; left time: 463.7107s
Epoch: 4 cost time: 18.110339641571045
Epoch: 4, Steps: 256 | Train Loss: 0.4699872 Vali Loss: 1.2832942 Test Loss: 0.4743294
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4827583
	speed: 0.4369s/iter; left time: 2864.5593s
	iters: 200, epoch: 5 | loss: 0.4590401
	speed: 0.0283s/iter; left time: 183.0474s
Epoch: 5 cost time: 8.41431474685669
Epoch: 5, Steps: 256 | Train Loss: 0.4675116 Vali Loss: 1.2814984 Test Loss: 0.4749618
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5010090
	speed: 0.4259s/iter; left time: 2683.4493s
	iters: 200, epoch: 6 | loss: 0.5140098
	speed: 0.0446s/iter; left time: 276.3400s
Epoch: 6 cost time: 12.944169759750366
Epoch: 6, Steps: 256 | Train Loss: 0.4655599 Vali Loss: 1.2825947 Test Loss: 0.4747227
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3771582
	speed: 0.3832s/iter; left time: 2316.4745s
	iters: 200, epoch: 7 | loss: 0.4560142
	speed: 0.0588s/iter; left time: 349.3463s
Epoch: 7 cost time: 15.1388258934021
Epoch: 7, Steps: 256 | Train Loss: 0.4652026 Vali Loss: 1.2840176 Test Loss: 0.4743165
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4568525
	speed: 0.4220s/iter; left time: 2442.9996s
	iters: 200, epoch: 8 | loss: 0.4368143
	speed: 0.0617s/iter; left time: 350.8785s
Epoch: 8 cost time: 17.07474422454834
Epoch: 8, Steps: 256 | Train Loss: 0.4646666 Vali Loss: 1.2835140 Test Loss: 0.4742340
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4258443
	speed: 0.5531s/iter; left time: 3060.4292s
	iters: 200, epoch: 9 | loss: 0.4421521
	speed: 0.0496s/iter; left time: 269.4841s
Epoch: 9 cost time: 12.410765886306763
Epoch: 9, Steps: 256 | Train Loss: 0.4645967 Vali Loss: 1.2815048 Test Loss: 0.4743658
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4023448
	speed: 0.3489s/iter; left time: 1841.0314s
	iters: 200, epoch: 10 | loss: 0.4777631
	speed: 0.0640s/iter; left time: 331.2273s
Epoch: 10 cost time: 17.52620768547058
Epoch: 10, Steps: 256 | Train Loss: 0.4645246 Vali Loss: 1.2841995 Test Loss: 0.4742950
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.4866629
	speed: 0.3935s/iter; left time: 1975.5538s
	iters: 200, epoch: 11 | loss: 0.4649273
	speed: 0.0645s/iter; left time: 317.5645s
Epoch: 11 cost time: 17.341511011123657
Epoch: 11, Steps: 256 | Train Loss: 0.4646011 Vali Loss: 1.2831095 Test Loss: 0.4742609
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.4078358
	speed: 0.3860s/iter; left time: 1839.2346s
	iters: 200, epoch: 12 | loss: 0.4827345
	speed: 0.0495s/iter; left time: 230.9796s
Epoch: 12 cost time: 15.512925624847412
Epoch: 12, Steps: 256 | Train Loss: 0.4640171 Vali Loss: 1.2838521 Test Loss: 0.4742804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : ETTh1_96_336_orthoCA_AConv_ETTh1_M_ft96_sl48_ll336_pl490_dm10_nh2_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4745665192604065, mae:0.449451208114624

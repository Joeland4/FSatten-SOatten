Args in experiment:
Namespace(Decomposition=1, activation='gelu', batch_size=32, c_out=8, channel_independence=False, checkpoints='./checkpoints/', class_strategy='projection', d_ff=128, d_layers=1, d_model=147, d_ortho=49, data='custom', data_path='exchange_rate.csv', dec_in=8, des='Exp', devices='0,1', distil=True, do_predict=False, dropout=0.1, e_layers=2, efficient_training=False, embed='timeF', enc_in=8, exp_name='MTSF', factor=1, features='M', freq='h', gpu=0, inverse=False, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', model='FCA_v1', model_id='Exchange_96_96', moving_avg=25, n_heads=3, num_workers=10, output_attention=False, partial_start_index=0, patience=10, pred_len=96, root_path='/data1/mazc/whxProject/Dataset/', seq_len=96, target='OT', target_data_path='electricity.csv', target_root_path='./data/electricity/', train_epochs=30, use_amp=False, use_gpu=True, use_multi_gpu=False, use_norm=True)
Use GPU: cuda:0
>>>>>>>start training : Exchange_96_96_FCA_v1_custom_M_ft96_sl48_ll96_pl147_dm3_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5120
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.1101706
	speed: 0.1451s/iter; left time: 682.1259s
Epoch: 1 cost time: 20.62214732170105
Epoch: 1, Steps: 160 | Train Loss: 0.1594929 Vali Loss: 0.1383400 Test Loss: 0.0903355
Validation loss decreased (inf --> 0.138340).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0960381
	speed: 0.4114s/iter; left time: 1868.2963s
Epoch: 2 cost time: 14.38570499420166
Epoch: 2, Steps: 160 | Train Loss: 0.1316023 Vali Loss: 0.1314118 Test Loss: 0.0864077
Validation loss decreased (0.138340 --> 0.131412).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1436029
	speed: 0.3943s/iter; left time: 1727.3002s
Epoch: 3 cost time: 15.260351181030273
Epoch: 3, Steps: 160 | Train Loss: 0.1251453 Vali Loss: 0.1339122 Test Loss: 0.0858467
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0841012
	speed: 0.4092s/iter; left time: 1727.1947s
Epoch: 4 cost time: 14.630252122879028
Epoch: 4, Steps: 160 | Train Loss: 0.1229261 Vali Loss: 0.1310288 Test Loss: 0.0861644
Validation loss decreased (0.131412 --> 0.131029).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0883912
	speed: 0.4073s/iter; left time: 1653.8608s
Epoch: 5 cost time: 16.6152400970459
Epoch: 5, Steps: 160 | Train Loss: 0.1215851 Vali Loss: 0.1307737 Test Loss: 0.0871146
Validation loss decreased (0.131029 --> 0.130774).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1729616
	speed: 0.4473s/iter; left time: 1745.0307s
Epoch: 6 cost time: 17.467278480529785
Epoch: 6, Steps: 160 | Train Loss: 0.1213186 Vali Loss: 0.1330592 Test Loss: 0.0865914
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0860919
	speed: 0.4046s/iter; left time: 1513.6733s
Epoch: 7 cost time: 17.140477418899536
Epoch: 7, Steps: 160 | Train Loss: 0.1210242 Vali Loss: 0.1314636 Test Loss: 0.0867860
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1645385
	speed: 0.4488s/iter; left time: 1607.3250s
Epoch: 8 cost time: 16.447072982788086
Epoch: 8, Steps: 160 | Train Loss: 0.1210001 Vali Loss: 0.1318960 Test Loss: 0.0868434
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1391771
	speed: 0.4064s/iter; left time: 1390.2270s
Epoch: 9 cost time: 15.580788135528564
Epoch: 9, Steps: 160 | Train Loss: 0.1207497 Vali Loss: 0.1326682 Test Loss: 0.0868246
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1231886
	speed: 0.4220s/iter; left time: 1376.0203s
Epoch: 10 cost time: 18.203155279159546
Epoch: 10, Steps: 160 | Train Loss: 0.1209238 Vali Loss: 0.1329076 Test Loss: 0.0868271
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1278522
	speed: 0.3912s/iter; left time: 1212.9658s
Epoch: 11 cost time: 12.852660655975342
Epoch: 11, Steps: 160 | Train Loss: 0.1208724 Vali Loss: 0.1302150 Test Loss: 0.0868329
Validation loss decreased (0.130774 --> 0.130215).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1304418
	speed: 0.4134s/iter; left time: 1215.6754s
Epoch: 12 cost time: 17.589768409729004
Epoch: 12, Steps: 160 | Train Loss: 0.1205537 Vali Loss: 0.1322322 Test Loss: 0.0868338
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1155431
	speed: 0.4931s/iter; left time: 1371.3139s
Epoch: 13 cost time: 19.187275171279907
Epoch: 13, Steps: 160 | Train Loss: 0.1208776 Vali Loss: 0.1305757 Test Loss: 0.0868359
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1046172
	speed: 0.4824s/iter; left time: 1264.3291s
Epoch: 14 cost time: 20.830681800842285
Epoch: 14, Steps: 160 | Train Loss: 0.1210178 Vali Loss: 0.1312008 Test Loss: 0.0868363
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1159801
	speed: 0.5355s/iter; left time: 1317.9331s
Epoch: 15 cost time: 20.67032527923584
Epoch: 15, Steps: 160 | Train Loss: 0.1205982 Vali Loss: 0.1305982 Test Loss: 0.0868369
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1248534
	speed: 0.5013s/iter; left time: 1153.4162s
Epoch: 16 cost time: 16.20576763153076
Epoch: 16, Steps: 160 | Train Loss: 0.1208565 Vali Loss: 0.1306265 Test Loss: 0.0868369
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.0957489
	speed: 0.4091s/iter; left time: 875.8327s
Epoch: 17 cost time: 16.98816990852356
Epoch: 17, Steps: 160 | Train Loss: 0.1208645 Vali Loss: 0.1323594 Test Loss: 0.0868369
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.1028389
	speed: 0.5023s/iter; left time: 994.9609s
Epoch: 18 cost time: 19.90031409263611
Epoch: 18, Steps: 160 | Train Loss: 0.1207528 Vali Loss: 0.1318282 Test Loss: 0.0868370
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.62939453125e-10
	iters: 100, epoch: 19 | loss: 0.1487190
	speed: 0.4825s/iter; left time: 878.6269s
Epoch: 19 cost time: 17.650558471679688
Epoch: 19, Steps: 160 | Train Loss: 0.1206074 Vali Loss: 0.1320616 Test Loss: 0.0868370
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.814697265625e-10
	iters: 100, epoch: 20 | loss: 0.1377594
	speed: 0.4985s/iter; left time: 828.0511s
Epoch: 20 cost time: 20.329675912857056
Epoch: 20, Steps: 160 | Train Loss: 0.1207052 Vali Loss: 0.1318644 Test Loss: 0.0868370
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.9073486328125e-10
	iters: 100, epoch: 21 | loss: 0.1033279
	speed: 0.4708s/iter; left time: 706.6792s
Epoch: 21 cost time: 18.32735323905945
Epoch: 21, Steps: 160 | Train Loss: 0.1207690 Vali Loss: 0.1315619 Test Loss: 0.0868370
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : Exchange_96_96_FCA_v1_custom_M_ft96_sl48_ll96_pl147_dm3_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
test shape: (1422, 1, 96, 8) (1422, 1, 96, 8)
test shape: (1422, 96, 8) (1422, 96, 8)
mse:0.0868329256772995, mae:0.20748066902160645
